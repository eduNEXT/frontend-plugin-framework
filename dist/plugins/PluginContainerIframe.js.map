{"version":3,"file":"PluginContainerIframe.js","names":["_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_classnames","_constants","_hooks","_shapes","_jsxRuntime","_excluded","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","value","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","_objectWithoutProperties","_objectWithoutPropertiesLoose","s","includes","propertyIsEnumerable","IFRAME_FEATURE_POLICY","exports","PluginContainerIframe","_ref","config","loadingFallback","className","props","url","title","mounted","setMounted","useState","ready","setReady","iframeRef","iframeElement","width","height","useElementSize","useEffect","dispatchPluginEvent","type","PLUGIN_RESIZE","payload","usePluginEvent","PLUGIN_MOUNTED","PLUGIN_READY","jsxs","Fragment","children","jsx","ref","src","allow","referrerPolicy","classNames","_default","propTypes","PropTypes","shape","iframePluginConfigShape","isRequired","node","string","defaultProps","undefined"],"sources":["../../src/plugins/PluginContainerIframe.jsx"],"sourcesContent":["import React, {\n  useEffect, useState,\n} from 'react';\nimport PropTypes from 'prop-types';\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport classNames from 'classnames';\n\nimport {\n  PLUGIN_MOUNTED,\n  PLUGIN_READY,\n  PLUGIN_RESIZE,\n} from './data/constants';\nimport {\n  dispatchPluginEvent,\n  useElementSize,\n  usePluginEvent,\n} from './data/hooks';\nimport { iframePluginConfigShape } from './data/shapes';\n\n/**\n * Feature policy for iframe, allowing access to certain courseware-related media.\n *\n * We must use the wildcard (*) origin for each feature, as courseware content\n * may be embedded in external iframes. Notably, xblock-lti-consumer is a popular\n * block that iframes external course content.\n\n * This policy was selected in conference with the edX Security Working Group.\n * Changes to it should be vetted by them (security@edx.org).\n */\nexport const IFRAME_FEATURE_POLICY = (\n  'fullscreen; microphone *; camera *; midi *; geolocation *; encrypted-media *'\n);\n\nfunction PluginContainerIframe({\n  config, loadingFallback, className, ...props\n}) {\n  const { url, title } = config;\n  const [mounted, setMounted] = useState(false);\n  const [ready, setReady] = useState(false);\n\n  const [iframeRef, iframeElement, width, height] = useElementSize();\n\n  useEffect(() => {\n    if (mounted) {\n      dispatchPluginEvent(iframeElement, {\n        type: PLUGIN_RESIZE,\n        payload: {\n          width,\n          height,\n        },\n      }, url);\n    }\n  }, [iframeElement, mounted, width, height, url]);\n\n  usePluginEvent(iframeElement, PLUGIN_MOUNTED, () => {\n    setMounted(true);\n  });\n\n  usePluginEvent(iframeElement, PLUGIN_READY, () => {\n    setReady(true);\n  });\n\n  return (\n    <>\n      <iframe\n        ref={iframeRef}\n        title={title}\n        src={url}\n        allow={IFRAME_FEATURE_POLICY}\n        referrerPolicy=\"origin\" // The sent referrer will be limited to the origin of the referring page: its scheme, host, and port.\n        className={classNames(\n          'border border-0 w-100',\n          { 'd-none': !ready },\n          className,\n        )}\n        {...props}\n      />\n      {!ready && loadingFallback}\n    </>\n  );\n}\n\nexport default PluginContainerIframe;\n\nPluginContainerIframe.propTypes = {\n  /** Configuration for the Plugin in this container (i.e. pluginSlot[id].example_plugin) */\n  config: PropTypes.shape(iframePluginConfigShape).isRequired,\n  /** Custom fallback component used when component is not ready (i.e. \"loading\") */\n  loadingFallback: PropTypes.node,\n  /** Classes to apply to the iframe */\n  className: PropTypes.string,\n};\n\nPluginContainerIframe.defaultProps = {\n  loadingFallback: null,\n  className: undefined,\n};\n"],"mappings":"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","ignoreList":[]}