{"version":3,"file":"PluginContainerIframe.js","names":["_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_classnames","_constants","_hooks","_shapes","_jsxRuntime","_excluded","obj","__esModule","default","_getRequireWildcardCache","e","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","key","value","_toPropertyKey","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","sourceSymbolKeys","indexOf","prototype","propertyIsEnumerable","IFRAME_FEATURE_POLICY","exports","PluginContainerIframe","_ref","config","loadingFallback","className","props","url","title","mounted","setMounted","useState","ready","setReady","iframeRef","iframeElement","width","height","useElementSize","useEffect","dispatchPluginEvent","type","PLUGIN_RESIZE","payload","usePluginEvent","PLUGIN_MOUNTED","PLUGIN_READY","jsxs","Fragment","children","jsx","ref","src","allow","referrerPolicy","classNames","_default","propTypes","PropTypes","shape","iframePluginConfigShape","node","string","defaultProps"],"sources":["../../src/plugins/PluginContainerIframe.jsx"],"sourcesContent":["import React, {\n  useEffect, useState,\n} from 'react';\nimport PropTypes from 'prop-types';\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport classNames from 'classnames';\n\nimport {\n  PLUGIN_MOUNTED,\n  PLUGIN_READY,\n  PLUGIN_RESIZE,\n} from './data/constants';\nimport {\n  dispatchPluginEvent,\n  useElementSize,\n  usePluginEvent,\n} from './data/hooks';\nimport { iframePluginConfigShape } from './data/shapes';\n\n/**\n * Feature policy for iframe, allowing access to certain courseware-related media.\n *\n * We must use the wildcard (*) origin for each feature, as courseware content\n * may be embedded in external iframes. Notably, xblock-lti-consumer is a popular\n * block that iframes external course content.\n\n * This policy was selected in conference with the edX Security Working Group.\n * Changes to it should be vetted by them (security@edx.org).\n */\nexport const IFRAME_FEATURE_POLICY = (\n  'fullscreen; microphone *; camera *; midi *; geolocation *; encrypted-media *'\n);\n\nfunction PluginContainerIframe({\n  config, loadingFallback, className, ...props\n}) {\n  const { url, title } = config;\n  const [mounted, setMounted] = useState(false);\n  const [ready, setReady] = useState(false);\n\n  const [iframeRef, iframeElement, width, height] = useElementSize();\n\n  useEffect(() => {\n    if (mounted) {\n      dispatchPluginEvent(iframeElement, {\n        type: PLUGIN_RESIZE,\n        payload: {\n          width,\n          height,\n        },\n      }, url);\n    }\n  }, [iframeElement, mounted, width, height, url]);\n\n  usePluginEvent(iframeElement, PLUGIN_MOUNTED, () => {\n    setMounted(true);\n  });\n\n  usePluginEvent(iframeElement, PLUGIN_READY, () => {\n    setReady(true);\n  });\n\n  return (\n    <>\n      <iframe\n        ref={iframeRef}\n        title={title}\n        src={url}\n        allow={IFRAME_FEATURE_POLICY}\n        referrerPolicy=\"origin\" // The sent referrer will be limited to the origin of the referring page: its scheme, host, and port.\n        className={classNames(\n          'border border-0 w-100',\n          { 'd-none': !ready },\n          className,\n        )}\n        {...props}\n      />\n      {!ready && loadingFallback}\n    </>\n  );\n}\n\nexport default PluginContainerIframe;\n\nPluginContainerIframe.propTypes = {\n  /** Configuration for the Plugin in this container (i.e. pluginSlot[id].example_plugin) */\n  config: PropTypes.shape(iframePluginConfigShape),\n  /** Custom fallback component used when component is not ready (i.e. \"loading\") */\n  loadingFallback: PropTypes.node,\n  /** Classes to apply to the iframe */\n  className: PropTypes.string,\n};\n\nPluginContainerIframe.defaultProps = {\n  config: null,\n  loadingFallback: null,\n  className: null,\n};\n"],"mappings":"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","ignoreList":[]}