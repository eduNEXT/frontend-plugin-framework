{"version":3,"file":"utils.js","names":["_react","_interopRequireDefault","require","_frontendPlatform","_constants","obj","__esModule","default","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","key","value","_toPropertyKey","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","call","TypeError","String","Number","organizePlugins","defaultContents","plugins","newContents","change","op","PLUGIN_OPERATIONS","Insert","widget","Hide","find","w","id","widgetId","hidden","Modify","widgetIdx","findIndex","fn","Wrap","newWidget","wrappers","wrapper","Error","sort","a","b","priority","localeCompare","exports","wrapComponent","renderComponent","reduce","component","idx","React","createElement","getConfigSlots","getConfig","pluginSlots","_default"],"sources":["../../../src/plugins/data/utils.jsx"],"sourcesContent":["import React from 'react';\nimport { getConfig } from '@edx/frontend-platform';\nimport { PLUGIN_OPERATIONS } from './constants';\n\n/**\n * Called by PluginSlot to prepare the plugin changes for the given slot\n *\n * @param {Array} defaultContents - The default widgets where the plugin slot exists.\n * @param {Array} plugins - All of the changes assigned to the specific plugin slot\n * @returns {Array} - A sorted list of widgets with any additional properties needed to render them in the plugin slot\n */\nexport const organizePlugins = (defaultContents, plugins) => {\n  const newContents = [...defaultContents];\n\n  plugins.forEach(change => {\n    if (change.op === PLUGIN_OPERATIONS.Insert) {\n      newContents.push(change.widget);\n    } else if (change.op === PLUGIN_OPERATIONS.Hide) {\n      const widget = newContents.find((w) => w.id === change.widgetId);\n      if (widget) { widget.hidden = true; }\n    } else if (change.op === PLUGIN_OPERATIONS.Modify) {\n      const widgetIdx = newContents.findIndex((w) => w.id === change.widgetId);\n      if (widgetIdx >= 0) {\n        const widget = { ...newContents[widgetIdx] };\n        newContents[widgetIdx] = change.fn(widget);\n      }\n    } else if (change.op === PLUGIN_OPERATIONS.Wrap) {\n      const widgetIdx = newContents.findIndex((w) => w.id === change.widgetId);\n      if (widgetIdx >= 0) {\n        const newWidget = { wrappers: [], ...newContents[widgetIdx] };\n        newWidget.wrappers.push(change.wrapper);\n        newContents[widgetIdx] = newWidget;\n      }\n    } else {\n      throw new Error('unknown direct plugin change operation');\n    }\n  });\n\n  newContents.sort((a, b) => (a.priority - b.priority) * 10_000 + a.id.localeCompare(b.id));\n  return newContents;\n};\n\n/** Wraps the plugin component with number of wrappers provided.\n *\n * @param {Function} renderComponent - Function that returns JSX (i.e. React Component)\n * @param {Array} wrappers - Array of components that each use a \"component\" prop to render the wrapped contents\n * @returns {React.ReactElement} - The plugin component wrapped by any number of wrappers provided.\n*/\nexport const wrapComponent = (renderComponent, wrappers) => wrappers.reduce(\n  // Disabled lint because currently we don't have a unique identifier for this\n  // The \"component\" and \"wrapper\" are both functions\n  // eslint-disable-next-line react/no-array-index-key\n  (component, wrapper, idx) => React.createElement(wrapper, { component, idx }),\n  renderComponent(),\n);\n\n/**\n * Called by usePluginSlot to retrieve the most up-to-date Config Document*\n * @returns {Object} - The pluginSlots object in Config Document\n */\nexport const getConfigSlots = () => getConfig()?.pluginSlots;\n\nexport default {\n  getConfigSlots,\n  organizePlugins,\n  wrapComponent,\n};\n"],"mappings":"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","ignoreList":[]}